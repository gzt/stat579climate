size<-dim(needles)
buffon<-2*dim[1]/sum(((needles[,2]-.5*abs(sin(needles[,3])))<0)|(needles[,2]+.5*abs(sin(needles[,3])))>1)
}
fix(p)
plotneedle<-function(needles){
length<-0.5
z<-(((needles[,2]-.5*abs(sin(needles[,3])))<0)|(needles[,2]+.5*abs(sin(needles[,3])))>1)
p<-ggplot()
p<-p+geom_vline(yintercept=c(0,1))
p<-p+geom_segment(aes(x=(needles[,2]-.5*abs(cos(needles[,3]))), xend=(needles[,2]+.5*abs(cos(needles[,3]))), y=(needles[,2]-.5*abs(sin(needles[,3]))), yend=(needles[,2]+.5*abs(sin(needles[,3]))), fill=z))
plotneedle<-p
}
buffon<-function(needles){
size<-dim(needles)
buffon<-2*dim[1]/sum(((needles[,2]-.5*abs(sin(needles[,3])))<0)|(needles[,2]+.5*abs(sin(needles[,3])))>1)
}
set.seed(1415)
X <- rneedle(50)
plotneedle(X)
buffon(X)
plotneedle<-function(needles){
length<-0.5
z<-(((needles[,2]-.5*abs(sin(needles[,3])))<0)|(needles[,2]+.5*abs(sin(needles[,3])))>1)
p<-ggplot()
p<-p+geom_vline(yintercept=c(0,1))
p<-p+geom_segment(aes(x=(needles[,2]-.5*abs(cos(needles[,3]))), xend=(needles[,2]+.5*abs(cos(needles[,3]))), y=(needles[,2]-.5*abs(sin(needles[,3]))), yend=(needles[,2]+.5*abs(sin(needles[,3]))), fill=z))
plotneedle<-p
}
buffon<-function(needles){
size<-dim(needles)
buffon<-2*size[1]/sum(((needles[,2]-.5*abs(sin(needles[,3])))<0)|(needles[,2]+.5*abs(sin(needles[,3])))>1)
}
set.seed(1415)
X <- rneedle(50)
plotneedle(X)
buffon(X)
fix(p)
plotneedle<-function(needles){
length<-0.5
z<-(((needles[,2]-.5*abs(sin(needles[,3])))<0)|(needles[,2]+.5*abs(sin(needles[,3])))>1)
p<-ggplot(needles)
p<-p+geom_vline(yintercept=c(0,1))
p<-p+geom_segment(aes(x=(needles[,2]-.5*abs(cos(needles[,3]))), xend=(needles[,2]+.5*abs(cos(needles[,3]))), y=(needles[,2]-.5*abs(sin(needles[,3]))), yend=(needles[,2]+.5*abs(sin(needles[,3]))), fill=z))
plotneedle<-p
}
buffon<-function(needles){
size<-dim(needles)
buffon<-2*size[1]/sum(((needles[,2]-.5*abs(sin(needles[,3])))<0)|(needles[,2]+.5*abs(sin(needles[,3])))>1)
}
set.seed(1415)
X <- rneedle(50)
plotneedle(X)
buffon(X)
rneedle<-function(n){
x<-runif(n,0,5)
y<-runif(n,0,1)
theta<-runif(n,-pi,pi)
rneedle<-cbind(x,y,theta)
}
needes<-rneedle(50)
z<-(((needles[,2]-.5*abs(sin(needles[,3])))<0)|(needles[,2]+.5*abs(sin(needles[,3])))>1)
needles<-rneedle(50)
z<-(((needles[,2]-.5*abs(sin(needles[,3])))<0)|(needles[,2]+.5*abs(sin(needles[,3])))>1)
geom_segment(aes(x=(needles[,2]-.5*abs(cos(needles[,3]))), xend=(needles[,2]+.5*abs(cos(needles[,3]))), y=(needles[,2]-.5*abs(sin(needles[,3]))), yend=(needles[,2]+.5*abs(sin(needles[,3]))), fill=z))
p<-ggplot()
p<-p+geom_vline(yintercept=c(0,1))
fix(p)
X <- rneedle(50)
z<-(((needles[,2]-.5*abs(sin(needles[,3])))<0)|(needles[,2]+.5*abs(sin(needles[,3])))>1)
framed<-data.frame(needles,z)
p<-ggplot(framed)
fix(p)
p<-p+geom_vline(yintercept=c(0,1))
p<-p+geom_segment(aes(x=(needles[,2]-.5*abs(cos(needles[,3]))), xend=(needles[,2]+.5*abs(cos(needles[,3]))), y=(needles[,2]-.5*abs(sin(needles[,3]))), yend=(needles[,2]+.5*abs(sin(needles[,3]))), fill=z))
fix(p)
fix(p)
set.seed(1415)
X <- rneedle(50)
plotneedle(X)
buffon(X)
buffon(X)
A<-buffon(X)
library(ggplot2)
rneedle<-function(n){
x<-runif(n,0,5)
y<-runif(n,0,1)
theta<-runif(n,-pi,pi)
rneedle<-data.frame(cbind(x,y,theta))
}
plotneedle<-function(needles){
z<-(((needles[,2]-.5*abs(sin(needles[,3])))<0)|(needles[,2]+.5*abs(sin(needles[,3])))>1)
framed<-data.frame(needles,z)
p<-ggplot(framed)
p<-p+geom_vline(yintercept=c(0,1))
p<-p+geom_segment(aes(x=(needles[,2]-.5*abs(cos(needles[,3]))), xend=(needles[,2]+.5*abs(cos(needles[,3]))), y=(needles[,2]-.5*abs(sin(needles[,3]))), yend=(needles[,2]+.5*abs(sin(needles[,3]))), fill=z))
plotneedle<-p
}
buffon<-function(needles){
size<-dim(needles)
buffon<-2*size[1]/sum(((needles[,2]-.5*abs(sin(needles[,3])))<0)|(needles[,2]+.5*abs(sin(needles[,3])))>1)
}
set.seed(1415)
X <- rneedle(50)
plotneedle(X)
A<-buffon(X)
fix(p)
z<-(((needles[,2]-.5*abs(sin(needles[,3])))<0)|(needles[,2]+.5*abs(sin(needles[,3])))>1)
framed<-data.frame(needles,z)
p<-ggplot(framed. aes(x=framed[,1], y=framed[,2]))
framed<-data.frame(needles,z)
framed
framed[,1]
p<-ggplot(framed. aes(x=framed[,1], y=framed[,2]))
framed[,1]
framed[,2]
p<-ggplot(framed. mapping=aes(x=framed[,1], y=framed[,2]))
p<-ggplot(framed,aes(x=framed[,2], y=framed[,3]))
p<-p+geom_vline(yintercept=c(0,1))
p<-p+geom_segment(aes(x=(framed[,2]-.5*abs(cos(framed[,3]))), xend=(framed[,2]+.5*abs(cos(framed[,3]))), y=(framed[,2]-.5*abs(sin(framed[,3]))), yend=(framed[,2]+.5*abs(sin(framed[,3]))), fill=framed[,4]))
plotneedle<-p
fix(plotneedle)
d <- ggplot(diamonds, aes(x=carat, y=price))
d + geom_point()
d + geom_point(aes(colour = carat))
d + geom_point(aes(colour = carat)) + scale_colour_brewer()
fix(d)
library(ggplot2)
# http://had.co.nz/ggplot2
# qplot examples -------------------------------------------------------------
qplot(diamonds$cut, diamonds$carat)
qplot(carat, price, data = diamonds)
qplot(carat, price, data = diamonds, colour=clarity)
qplot(carat, price, data = diamonds, geom=c("point", "smooth"), method=lm)
qplot(carat, data = diamonds,
geom="histogram")
qplot(carat, data = diamonds,
geom="histogram", binwidth = 1)
qplot(carat, data = diamonds,
geom="histogram", binwidth = 0.1)
qplot(carat, data = diamonds,
geom="histogram", binwidth = 0.01)
# using ggplot() -------------------------------------------------------------
d <- ggplot(diamonds, aes(x=carat, y=price))
d + geom_point()
d + geom_point(aes(colour = carat))
d + geom_point(aes(colour = carat)) + scale_colour_brewer()
ggplot(diamonds) + geom_histogram(aes(x=price))
# Separation of statistcs and geometric elements -----------------------------
p <- ggplot(diamonds, aes(x=price))
p + geom_histogram()
p + stat_bin(geom="area")
p + stat_bin(geom="point")
p + stat_bin(geom="line")
p + geom_histogram(aes(fill = clarity))
p + geom_histogram(aes(y = ..density..))
# Setting vs mapping ---------------------------------------------------------
p <- ggplot(diamonds, aes(x=carat,y=price))
# What will this do?
p + geom_point(aes(colour = "green"))
p + geom_point(colour = "green")
p + geom_point(colour = colour)
p<-qplot(needles[,1], needles[,2], fill=z)
library(ggplot2)
p<-qplot(needles[,1], needles[,2], fill=z)
p<-qplot(needles[,1], needles[,2], fill=z, data=needles)
qplot(needles[,1], needles[,2], fill=z, data=needles)
sequence<-"AAACCGCGAGCGCATCGACTCGCTAGCTACGGCATCAGCGATTCATCTTCAGGGAGGAGGCTCACACTTATTTATACGCGCGAGCGATCGAGCTGCATGCGAGCATCAGCGATCAGGCGAGCATCAGGCAGGCGCGGGGCATTCTTCAGGCAGGCAGCTATCAGCGACCCCCCCCCCCGAGCATCGAGCTGATCAGGCGACTAGGCAGCGATCGAGCGAGCGAGGCGAGGAATTCTTCGC"
a<-gsub('.{10}','\1 ', sequence)
sequence<-"AAACCGCGAGCGCATCGACTCGCTAGCTACGGCATCAGCGATTCATCTTCAGGGAGGAGGCTCACACTTATTTATACGCGCGAGCGATCGAGCTGCATGCGAGCATCAGCGATCAGGCGAGCATCAGGCAGGCGCGGGGCATTCTTCAGGCAGGCAGCTATCAGCGACCCCCCCCCCCGAGCATCGAGCTGATCAGGCGACTAGGCAGCGATCGAGCGAGCGAGGCGAGGAATTCTTCGCAAA"
a<-gsub('.{10}',\1' ', sequence)
sequence<-"AAACCGCGAGCGCATCGACTCGCTAGCTACGGCATCAGCGATTCATCTTCAGGGAGGAGGCTCACACTTATTTATACGCGCGAGCGATCGAGCTGCATGCGAGCATCAGCGATCAGGCGAGCATCAGGCAGGCGCGGGGCATTCTTCAGGCAGGCAGCTATCAGCGACCCCCCCCCCCGAGCATCGAGCTGATCAGGCGACTAGGCAGCGATCGAGCGAGCGAGGCGAGGAATTCTTCGCAAA"
a<-gsub('\1.{10}','\1 ', sequence)
fix(a)
a<-gsub('\1=.{10}','\1 ', sequence)
fix(a)
a<-gsub('.{10}','\\1 ', sequence)
a<-gsub('(.{10})','\\1 ', sequence)
fix(a)
fix(a)
bigfile<-read.csv("ensemble1.csv")
setwd("~/Documents/GitHub/stat579climate")
bigfile<-read.csv("ensemble1.csv")
library(plyr)
library(lubridate)
head(bigfile)
annualbigfile<-ddply(bigfile,.(year,yloc,xloc),summarise,
newvalue=mean(value, na.rm=TRUE))
summary(bigfile$xloc)
a<-subset(bigfile,xloc==c("row"))
View(a)
bigfile<-subset(bigfile,xloc!=c("row"))
write.csv(bigfile,"ensemble1.csv")
annualbigfile<-ddply(bigfile,.(year,yloc,xloc),summarise,
newvalue=mean(value, na.rm=TRUE))
write.csv(annualbigfile,"annualensemble1.csv")
summary(annualbigfile)
387288/5868
annual<-read.csv(annualensemble1.csv)
annual<-read.csv("annualensemble1.csv")
head(annual)
annual$realyear<-(annual$year+1849)
annual$long<-(180-annual$xloc*5)
annual$lat<-(90-annual$yloc*5)
write.csv(annual,"annualensemble1.csv")
annual<-read.csv("annualensemble1.csv")
View(monthly)
annual$xloc<-as.numeric(as.character(annual$xloc))
summary(annual)
summary(jan)
summary(jan2012)
annual<-subset(annual, select = -X)
summary(annual)
annual<-subset(annual, select = -X.1)
jan<-subset(jan, select= -X)
jan<-subset(jan, select= -X.1)
jan<-subset(jan, select= -X.2)
jan2012<-subset(jan2012, select= -X)
jan2012<-subset(jan2012, select= -X.1)
jan2012<-subset(jan2012, select= -X.2)
last20<-subset(last20, select= -X)
last20<-subset(last20, select= -X.1)
last20<-subset(last20, select= -X.2)
head(last20)
fix(p)
print(p)
head(annual)
year2000<-ggplot()
year2000 <- year2000 + geom_polygon( data=worldmap, aes(x=long, y=lat, group = group),colour="black", fill="white" )+ theme(aspect.ratio=1/2)+coord_cartesian(ylim=c(-90,90), xlim=c(-180,180))+scale_y_continuous(breaks=seq(-90, 90, 15))+scale_x_continuous(breaks=seq(-180, 180, 15))
q<-q+geom_tile(data=(annual$realyear==2000), aes(x=long,y=lat,fill=value, alpha=.25))+  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0,space = "rgb", na.value = "grey50",guide = "colourbar")+theme_bw()
year2000
library(ggplot2)
library(lubridate)
library(RColorBrewer)
library(maps)
library(scale)
year2000<-ggplot()
year2000 <- year2000 + geom_polygon( data=worldmap, aes(x=long, y=lat, group = group),colour="black", fill="white" )+ theme(aspect.ratio=1/2)+coord_cartesian(ylim=c(-90,90), xlim=c(-180,180))+scale_y_continuous(breaks=seq(-90, 90, 15))+scale_x_continuous(breaks=seq(-180, 180, 15))
q<-q+geom_tile(data=(annual$realyear==2000), aes(x=long,y=lat,fill=value, alpha=.25))+  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0,space = "rgb", na.value = "grey50",guide = "colourbar")+theme_bw()
q<-q+geom_tile(data=(subset(annual, realyear==2000)), aes(x=long,y=lat,fill=value, alpha=.25))+  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0,space = "rgb", na.value = "grey50",guide = "colourbar")+theme_bw()
year2000
year2000<-ggplot()
year2000 <- year2000 + geom_polygon( data=worldmap, aes(x=long, y=lat, group = group),colour="black", fill="white" )+ theme(aspect.ratio=1/2)+coord_cartesian(ylim=c(-90,90), xlim=c(-180,180))+scale_y_continuous(breaks=seq(-90, 90, 15))+scale_x_continuous(breaks=seq(-180, 180, 15))
q<-q+geom_tile(data=(subset(annual, realyear==2000)), aes(x=long,y=lat,fill=value, alpha=.25))+  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0,space = "rgb", na.value = "grey50",guide = "colourbar")+theme_bw()
year2000
summary(annual)
year2000<-ggplot()
year2000 <- year2000 + geom_polygon( data=worldmap, aes(x=long, y=lat, group = group),colour="black", fill="white" )+ theme(aspect.ratio=1/2)+coord_cartesian(ylim=c(-90,90), xlim=c(-180,180))+scale_y_continuous(breaks=seq(-90, 90, 15))+scale_x_continuous(breaks=seq(-180, 180, 15))
q<-q+geom_tile(data=(subset(annual, realyear==2000)), aes(x=long,y=lat,fill=newvalue, alpha=.25))+  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0,space = "rgb", na.value = "grey50",guide = "colourbar")+theme_bw()
year2000
summary(subset(annual$realyear==2000))
summary(subset(annual, realyear==2000))
36*72
y2k<-subset(annual, realyear==2000)
year2000<-ggplot()
year2000 <- year2000 + geom_polygon( data=worldmap, aes(x=long, y=lat, group = group),colour="black", fill="white" )+ theme(aspect.ratio=1/2)+coord_cartesian(ylim=c(-90,90), xlim=c(-180,180))+scale_y_continuous(breaks=seq(-90, 90, 15))+scale_x_continuous(breaks=seq(-180, 180, 15))
q<-q+geom_tile(data=y2k, aes(x=long,y=lat,fill=newvalue, alpha=.25))+  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0,space = "rgb", na.value = "grey50",guide = "colourbar")+theme_bw()
year2000
year2000<-ggplot()
year2000 <- year2000 + geom_polygon( data=worldmap, aes(x=long, y=lat, group = group),colour="black", fill="white" )+ theme(aspect.ratio=1/2)+coord_cartesian(ylim=c(-90,90), xlim=c(-180,180))+scale_y_continuous(breaks=seq(-90, 90, 15))+scale_x_continuous(breaks=seq(-180, 180, 15))
year2000<-year2000+geom_tile(data=y2k, aes(x=long,y=lat,fill=newvalue, alpha=.25))+  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0,space = "rgb", na.value = "grey50",guide = "colourbar")+theme_bw()
year2000
y2k<-subset(annual, realyear==1925)
year2000<-ggplot()
year2000 <- year2000 + geom_polygon( data=worldmap, aes(x=long, y=lat, group = group),colour="black", fill="white" )+ theme(aspect.ratio=1/2)+coord_cartesian(ylim=c(-90,90), xlim=c(-180,180))+scale_y_continuous(breaks=seq(-90, 90, 15))+scale_x_continuous(breaks=seq(-180, 180, 15))
year2000<-year2000+geom_tile(data=y2k, aes(x=long,y=lat,fill=newvalue, alpha=.25))+  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0,space = "rgb", na.value = "grey50",guide = "colourbar")+theme_bw()
year2000
y2k<-subset(annual, realyear==1900)
year2000<-ggplot()
year2000 <- year2000 + geom_polygon( data=worldmap, aes(x=long, y=lat, group = group),colour="black", fill="white" )+ theme(aspect.ratio=1/2)+coord_cartesian(ylim=c(-90,90), xlim=c(-180,180))+scale_y_continuous(breaks=seq(-90, 90, 15))+scale_x_continuous(breaks=seq(-180, 180, 15))
year2000<-year2000+geom_tile(data=y2k, aes(x=long,y=lat,fill=newvalue, alpha=.25))+  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0,space = "rgb", na.value = "grey50",guide = "colourbar")+theme_bw()
year2000
y2k<-subset(annual, realyear==1900)
year2000<-ggplot()
year2000 <- year2000 + geom_polygon( data=worldmap, aes(x=long, y=lat, group = group),colour="black", fill="white" )+ theme(aspect.ratio=1/2)+coord_cartesian(ylim=c(-90,90), xlim=c(-180,180))+scale_y_continuous(breaks=seq(-90, 90, 15))+scale_x_continuous(breaks=seq(-180, 180, 15))
year2000<-year2000+geom_tile(data=y2k, aes(x=-long,y=lat,fill=newvalue, alpha=.25))+  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0,space = "rgb", na.value = "grey50",guide = "colourbar")+theme_bw()
year2000
p<-ggplot()
p <- p + geom_polygon( data=worldmap, aes(x=long, y=lat, group = group),colour="black", fill="white" )+ theme(aspect.ratio=1/2)+coord_cartesian(ylim=c(-90,90), xlim=c(-180,180))+scale_y_continuous(breaks=seq(-90, 90, 15))+scale_x_continuous(breaks=seq(-180, 180, 15))
p<-p+geom_tile(data=jan2012, aes(x=long,y=lat,fill=value,alpha=.25))+  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0,space = "rgb", na.value = "grey50",guide = "colourbar")+theme_bw()
p
p<-ggplot()
p <- p + geom_polygon( data=worldmap, aes(x=long, y=lat, group = group),colour="black", fill="white" )+ theme(aspect.ratio=1/2)+coord_cartesian(ylim=c(-90,90), xlim=c(-180,180))+scale_y_continuous(breaks=seq(-90, 90, 15))+scale_x_continuous(breaks=seq(-180, 180, 15))
p<-p+geom_tile(data=jan2012, aes(x=-long,y=lat,fill=value,alpha=.25))+  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0,space = "rgb", na.value = "grey50",guide = "colourbar")+theme_bw()
p
y2k<-subset(annual, realyear==2011)
year2000<-ggplot()
year2000 <- year2000 + geom_polygon( data=worldmap, aes(x=long, y=lat, group = group),colour="black", fill="white" )+ theme(aspect.ratio=1/2)+coord_cartesian(ylim=c(-90,90), xlim=c(-180,180))+scale_y_continuous(breaks=seq(-90, 90, 15))+scale_x_continuous(breaks=seq(-180, 180, 15))
year2000<-year2000+geom_tile(data=y2k, aes(x=-long,y=lat,fill=newvalue, alpha=.25))+  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0,space = "rgb", na.value = "grey50",guide = "colourbar")+theme_bw()
year2000
y2k<-subset(annual, realyear==2011)
year2000<-ggplot()
year2000 <- year2000 + geom_polygon( data=worldmap, aes(x=long, y=lat, group = group),colour="black", fill="white" )+ theme(aspect.ratio=1/2)+coord_cartesian(ylim=c(-90,90), xlim=c(-180,180))+scale_y_continuous(breaks=seq(-90, 90, 15))+scale_x_continuous(breaks=seq(-180, 180, 15))
year2000<-year2000+geom_tile(data=y2k, aes(x=(-long-2.5),y=(lat+2.5),fill=newvalue, alpha=.25))+  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0,space = "rgb", na.value = "grey50",guide = "colourbar")+theme_bw()
year2000
annual$long<- (-annual$long)
write.csv(annual,"annualensemble1.csv")
jan$long<- (-jan$long)
write.csv(jan),"ensemble1_jan.csv")
write.csv(jan,"ensemble1_jan.csv")
last20$long<- (-last20$long)
write.csv(last20,"ensemble1_last20.csv")
jan2012$long<- (-jan2012$long)
q<-ggplot()
q <- q + geom_polygon( data=worldmap, aes(x=long, y=lat, group = group),colour="black", fill="white" )+ theme(aspect.ratio=1/2)+coord_cartesian(ylim=c(-90,90), xlim=c(-180,180))+scale_y_continuous(breaks=seq(-90, 90, 15))+scale_x_continuous(breaks=seq(-180, 180, 15))
q<-q+geom_tile(data=sep2012, aes(x=(long+2.5),y=lat,fill=value, alpha=.25))+  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0,space = "rgb", na.value = "grey50",guide = "colourbar")+theme_bw()
q
q<-ggplot()
q <- q + geom_polygon( data=worldmap, aes(x=long, y=lat, group = group),colour="black", fill="white" )+ theme(aspect.ratio=1/2)+coord_cartesian(ylim=c(-90,90), xlim=c(-180,180))+scale_y_continuous(breaks=seq(-90, 90, 15))+scale_x_continuous(breaks=seq(-180, 180, 15))
q<-q+geom_tile(data=sep2012, aes(x=-(long+2.5),y=lat,fill=value, alpha=.25))+  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0,space = "rgb", na.value = "grey50",guide = "colourbar")+theme_bw()
q
jan<-read.csv("ensemble1_jan.csv")
head(jan)
sep2012<-subset(last20,((realyear==2012)&(month==9)))
q<-ggplot()
q <- q + geom_polygon( data=worldmap, aes(x=long, y=lat, group = group),colour="black", fill="white" )+ theme(aspect.ratio=1/2)+coord_cartesian(ylim=c(-90,90), xlim=c(-180,180))+scale_y_continuous(breaks=seq(-90, 90, 15))+scale_x_continuous(breaks=seq(-180, 180, 15))
q<-q+geom_tile(data=sep2012, aes(x=(long+2.5),y=lat,fill=value, alpha=.25))+  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0,space = "rgb", na.value = "grey50",guide = "colourbar")+theme_bw()
print(q)
(.3*20)^2+(.7*45)^2
sqrt((.3*20)^2+(.7*45)^2)
sqrt((.2$25)^2 + (.8*42)^2)
sqrt((.2*25)^2 + (.8*42)^2)
(.2*25)^2 + (.8*42)^2
jan<-read.csv("ensemble1_jan.csv")
last20<-read.csv("ensemble1_last20.csv")
monthly<-read.csv("monthlyglobaldev.csv")
ensemble1 <- read.csv("ensemble1.csv")
suppressMessages(library(ggplot2))
suppressMessages(require(lubridate))
suppressMessages(library(RColorBrewer))
suppressMessages(library(maps))
jan2012<-subset(jan,realyear==2012)
sep2012<-subset(last20,((realyear==2012)&(month==9)))
worldmap<-map_data("world")
monthly$fixedtime<-ymd(monthly$fixedtime)
ensemble1$fixedtime <- ymd(ensemble1$fixedtime)
recent<-subset(monthly, year(fixedtime)>1975)
recent97<-subset(monthly, X > (max(X) - 180)) #Last 16 years of data
head(ensemble1)
summary(ensemble1)
head(monthly)
head(ensemble1)
ensemble1$fixedyear<- ensemble1$year +1849
ensemble1$fixedtime<-paste(ensemble1$month,ensemble1$fixedyear,sep="//1//")
head(ensemble1)
ensemble1$fixedtime<-paste(ensemble1$month,ensemble1$fixedyear,sep="/1/")
ensemble1<-subset(ensemble1, select= -X.1)
head(ensemble1)
write.csv(ensemble1,"ensemble1.csv")
ensemble1$fixedtime <- ymd(ensemble1$fixedtime)
head(ensemble1)
?lubridate
ensemble1$fixedtime <- mdy(ensemble1$fixedtime)
ensemble1$long<-(ensemble1$xloc*5)
ensemble1$lat<-(90-ensemble$yloc*5)
write.csv(ensemble1,"ensemble1.csv")
ensemble1 <- read.csv("ensemble1.csv")
head(ensemble1)
ensemble1$lat<-(90-ensemble1$yloc*5)
ensemble1<-subset(ensemble1, select= -X.1)
write.csv(ensemble1,"ensemble1.csv")
head(ensemble)
jan<-read.csv("ensemble1_jan.csv")
last20<-read.csv("ensemble1_last20.csv")
monthly<-read.csv("monthlyglobaldev.csv")
ensemble1 <- read.csv("ensemble1.csv")
ensemble1 <- read.csv("ensemble1.csv")
ensemble1$long<-(ensemble1$xloc*5)
ensemble1$lat<-(90-ensemble1$yloc*5)
head(ensemble1)
ensemble1<-subset(ensemble1,select = -X.1)
ensemble1$realyear<-ensemble1$year+1849
ensemble1$fixedtime<-paste(ensemble1$realyear,ensemble1$month,"01",sep="-")
head(ensemble1)
write.csv(ensemble1,"ensemble1.csv")
head(ensemble1)
summary(ensemble1)
ensemble1$long<-ensemble1$long-180
write.csv(ensemble1,"ensemble1.csv")
jan<-read.csv("ensemble1_jan.csv")
last20<-read.csv("ensemble1_last20.csv")
monthly<-read.csv("monthlyglobaldev.csv")
ensemble1 <- read.csv("ensemble1.csv")
summary(ensemble1)
ensemble1$fixedtime <- ymd(ensemble1$fixedtime)
suppressMessages(require(lubridate))
ensemble1$fixedtime <- ymd(ensemble1$fixedtime)
stuff<-subset(ensemble1,lat==40 & long==-95 & realyear>1865)
View(stuff)
stuff<-subset(ensemble1,lat==50 & long==10)
View(stuff)
View(stuff)
stuff<-subset(ensemble1,lat==-75 & long==15 & realyear>1960)
View(stuff)
jan<-read.csv("ensemble1_jan.csv")
last20<-read.csv("ensemble1_last20.csv")
monthly<-read.csv("monthlyglobaldev.csv")
ensemble1 <- read.csv("ensemble1.csv")
suppressMessages(library(ggplot2))
suppressMessages(require(lubridate))
suppressMessages(library(RColorBrewer))
suppressMessages(library(maps))
jan2012<-subset(jan,realyear==2012)
sep2012<-subset(last20,((realyear==2012)&(month==9)))
worldmap<-map_data("world")
ensemble1$realyear<-ensemble1$fixedyear
monthly$fixedtime<-ymd(monthly$fixedtime)
ensemble1$fixedtime <- ymd(ensemble1$fixedtime)
recent<-subset(monthly, year(fixedtime)>1975)
recent97<-subset(monthly, X > (max(X) - 180)) #Last 16 years of data
suppressMessages(library(ggplot2))
qplot(fixedtime,value,data=subset(ensemble1,lat==40 & long==-95 & realyear>1865),geom="line",color=value,na.rm=T) + geom_smooth(se=FALSE,color="red",na.rm=T)
head(ensemble1)
ensemble1$fixedyear<-ensemble1$year+1949
ensemble1<-subset(ensemble1, select= -X.1)
ensemble1<-subset(ensemble1, select= -X)
write.csv(ensemble1,"ensemble1.csv")
jan<-read.csv("ensemble1_jan.csv")
last20<-read.csv("ensemble1_last20.csv")
monthly<-read.csv("monthlyglobaldev.csv")
ensemble1 <- read.csv("ensemble1.csv")
suppressMessages(library(ggplot2))
suppressMessages(require(lubridate))
suppressMessages(library(RColorBrewer))
suppressMessages(library(maps))
jan2012<-subset(jan,realyear==2012)
sep2012<-subset(last20,((realyear==2012)&(month==9)))
worldmap<-map_data("world")
ensemble1$realyear<-ensemble1$fixedyear
monthly$fixedtime<-ymd(monthly$fixedtime)
ensemble1$fixedtime <- ymd(ensemble1$fixedtime)
recent<-subset(monthly, year(fixedtime)>1975)
recent97<-subset(monthly, X > (max(X) - 180)) #Last 16 years of data
suppressMessages(library(ggplot2))
qplot(fixedtime,anomaly,data=monthly,geom="line",color=anomaly) + geom_smooth(se=FALSE,color="red")
suppressMessages(library(ggplot2))
qplot(fixedtime,anomaly,data=recent97, color=anomaly) + geom_smooth(method="lm", se=FALSE, color="red")
suppressMessages(library(ggplot2))
qplot(fixedtime,anomaly,data=recent, color=anomaly) + geom_smooth(method="lm", se=FALSE, color="red")
suppressMessages(library(ggplot2))
qplot(fixedtime,value,data=subset(ensemble1,lat==40 & long==-95 & realyear>1865),geom="line",color=value,na.rm=T) + geom_smooth(se=FALSE,color="red",na.rm=T)
suppressMessages(library(ggplot2))
qplot(fixedtime,value,data=subset(ensemble1,lat==50 & long==10),geom="line",color=value) + geom_smooth(se=FALSE,color="red")
suppressMessages(library(ggplot2))
qplot(fixedtime,value,data=subset(ensemble1,lat==-75 & long==15 & realyear>1960),geom="line",color=value,na.rm=T) + geom_smooth(se=FALSE,color="red",na.rm=T)
suppressMessages(library(ggplot2))
qplot(fixedtime,value,data=subset(ensemble1,lat==-75 & long==15 & realyear>1960,xlim=c(1960,2013)),geom="line",color=value,na.rm=T) + geom_smooth(se=FALSE,color="red",na.rm=T)
qplot(fixedtime,value,data=subset(ensemble1,lat==-75 & long==15 & realyear>1960),xlim=c(1960,2013),geom="line",color=value,na.rm=T) + geom_smooth(se=FALSE,color="red",na.rm=T)
qplot(fixedtime,value,data=subset(ensemble1,lat==-75 & long==15 & realyear>1960), xlim=c(1960,2013),geom="line",color=value,na.rm=T) + geom_smooth(se=FALSE,color="red",na.rm=T)
qplot(fixedtime,value,data=subset(ensemble1,lat==-75 & long==15 & realyear>1960),geom="line",color=value,na.rm=T)+scale_x_continuous(c(1960,2013)) + geom_smooth(se=FALSE,color="red",na.rm=T)
qplot(fixedtime,value,data=subset(ensemble1,lat==-75 & long==15 & realyear>1960),geom="line",color=value,na.rm=T) + geom_smooth(se=FALSE,color="red",na.rm=T)
suppressMessages(library(ggplot2))
sep2012<-subset(last20,((realyear==1997)&(month==9)))
q<-ggplot()
q <- q + geom_polygon( data=worldmap, aes(x=long, y=lat, group = group),colour="black", fill="white" )+ theme(aspect.ratio=1/2)+coord_cartesian(ylim=c(-90,90), xlim=c(-180,180))+scale_y_continuous(breaks=seq(-90, 90, 15))+scale_x_continuous(breaks=seq(-180, 180, 15))
q<-q+geom_tile(data=sep2012, aes(x=long,y=lat,fill=value, alpha=.25))+  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0,space = "rgb", na.value = "grey50",guide = "colourbar")+theme_bw()
print(q)
suppressMessages(library(ggplot2))
qplot(fixedtime,anomaly,data=monthly,geom="line",color=anomaly) + geom_smooth(se=FALSE,color="red")
suppressMessages(library(ggplot2))
qplot(fixedtime,anomaly,data=recent97, color=anomaly) + geom_smooth(method="lm", se=FALSE, color="red")
suppressMessages(library(ggplot2))
qplot(fixedtime,anomaly,data=recent, color=anomaly) + geom_smooth(method="lm", se=FALSE, color="red")
suppressMessages(library(ggplot2))
qplot(fixedtime,value,data=subset(ensemble1,lat==40 & long==-95 & realyear>1865),geom="line",color=value,na.rm=T) + geom_smooth(se=FALSE,color="red",na.rm=T)
suppressMessages(library(ggplot2))
qplot(fixedtime,value,data=subset(ensemble1,lat==50 & long==10),geom="line",color=value) + geom_smooth(se=FALSE,color="red")
suppressMessages(library(ggplot2))
qplot(fixedtime,value,data=subset(ensemble1,lat==-75 & long==15 & realyear>1960),geom="line",color=value,na.rm=T) + geom_smooth(se=FALSE,color="red",na.rm=T)
suppressMessages(library(ggplot2))
sep2012<-subset(ensemble1,((realyear==1978)&(month==9)))
q<-ggplot()
q <- q + geom_polygon( data=worldmap, aes(x=long, y=lat, group = group),colour="black", fill="white" )+ theme(aspect.ratio=1/2)+coord_cartesian(ylim=c(-90,90), xlim=c(-180,180))+scale_y_continuous(breaks=seq(-90, 90, 15))+scale_x_continuous(breaks=seq(-180, 180, 15))
q<-q+geom_tile(data=sep2012, aes(x=long,y=lat,fill=value, alpha=.25))+  scale_fill_gradient2(limits=c(-5,5),low = "blue", mid = "white", high = "red", midpoint = 0,space = "rgb", na.value = "grey50",guide = "colourbar")+theme_bw()
print(q)
suppressMessages(library(ggplot2))
sep2012<-subset(last20,((realyear==1997)&(month==9)))
q<-ggplot()
q <- q + geom_polygon( data=worldmap, aes(x=long, y=lat, group = group),colour="black", fill="white" )+ theme(aspect.ratio=1/2)+coord_cartesian(ylim=c(-90,90), xlim=c(-180,180))+scale_y_continuous(breaks=seq(-90, 90, 15))+scale_x_continuous(breaks=seq(-180, 180, 15))
q<-q+geom_tile(data=sep2012, aes(x=long,y=lat,fill=value, alpha=.25))+  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0,space = "rgb", na.value = "grey50",guide = "colourbar")+theme_bw()
print(q)
suppressMessages(library(ggplot2))
sep2012<-subset(last20,((realyear==2012)&(month==9)))
q<-ggplot()
q <- q + geom_polygon( data=worldmap, aes(x=long, y=lat, group = group),colour="black", fill="white" )+ theme(aspect.ratio=1/2)+coord_cartesian(ylim=c(-90,90), xlim=c(-180,180))+scale_y_continuous(breaks=seq(-90, 90, 15))+scale_x_continuous(breaks=seq(-180, 180, 15))
q<-q+geom_tile(data=sep2012, aes(x=long,y=lat,fill=value, alpha=.25))+  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0,space = "rgb", na.value = "grey50",guide = "colourbar")+theme_bw()
print(q)
jan<-read.csv("ensemble1_jan.csv")
last20<-read.csv("ensemble1_last20.csv")
monthly<-read.csv("monthlyglobaldev.csv")
ensemble1 <- read.csv("ensemble1.csv")
suppressMessages(library(ggplot2))
suppressMessages(require(lubridate))
suppressMessages(library(RColorBrewer))
suppressMessages(library(maps))
jan2012<-subset(jan,realyear==2012)
sep2012<-subset(last20,((realyear==2012)&(month==9)))
worldmap<-map_data("world")
ensemble1$realyear<-ensemble1$fixedyear
monthly$fixedtime<-ymd(monthly$fixedtime)
ensemble1$fixedtime <- ymd(ensemble1$fixedtime)
recent<-subset(monthly, year(fixedtime)>1975)
recent97<-subset(monthly, X > (max(X) - 180)) #Last 16 years of data
suppressMessages(library(ggplot2))
sep2012<-subset(ensemble1,((realyear==1978)&(month==9)))
q<-ggplot()
q <- q + geom_polygon( data=worldmap, aes(x=long, y=lat, group = group),colour="black", fill="white" )+ theme(aspect.ratio=1/2)+coord_cartesian(ylim=c(-90,90), xlim=c(-180,180))+scale_y_continuous(breaks=seq(-90, 90, 15))+scale_x_continuous(breaks=seq(-180, 180, 15))
q<-q+geom_tile(data=sep2012, aes(x=long,y=lat,fill=value, alpha=.25))+  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0,space = "rgb", na.value = "grey50",guide = "colourbar")+theme_bw()
print(q)
View(sep2012)
head(ensemble1)
write.csv(ensemble1,"ensemble1.csv")
View(worldmap)
